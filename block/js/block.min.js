!function(e,t){var d=window.wp.element.createElement,a=e.registerBlockType,m=t.TextControl;a("blocks/amazon-product",{title:"Amazon Product",description:"A custom block for getting amazon product details.",icon:"businessman",category:"common",attributes:{url:{type:"string"},category:{type:"string"},headline:{type:"string"},review:{type:"string"},buyLink:{type:"string"},productImage:{type:"string"},checkPrice:{type:"string"},price:{type:"string"},isUrlPresent:{type:"boolean",default:!1},loaderState:{type:"boolean",default:!1}},edit:function(a){var e=a.attributes.url,t=a.attributes.category,r=a.attributes.headline,i=a.attributes.price,s=a.attributes.review,n=a.attributes.productImage,l=a.attributes.buyLink,c=a.attributes.checkPrice,o=a.attributes.isUrlPresent,u=a.attributes.loaderState;return d("div",null,a.isSelected&&d("div",{className:"block--main"},d("h2",{className:"block--heading"},"Amazon Product Form"),d("div",null,d(m,{value:e,onChange:function(e){var t,i;a.setAttributes({url:e,isUrlPresent:!1}),t=e,(i=a).setAttributes({buyLink:"",headline:"",productImage:"",price:"",checkPrice:"",review:"",category:""}),t.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&=]*)/)&&t.match(/(?:dp|o|gp|-)\/(B[0-9]{2}[0-9A-Z]{7}|[0-9]{9}(?:X|[0-9]))/)&&(i.setAttributes({loaderState:!0}),jQuery.post("admin-ajax.php",{action:"fetch_product",productId:/(?:dp|o|gp|-)\/(B[0-9]{2}[0-9A-Z]{7}|[0-9]{9}(?:X|[0-9]))/.exec(t)[1]},function(e){var t,a,r;e?(t=JSON.parse(e)).Errors?(a="",t.Errors.forEach(function(e){a+=e.Message+"\n"}),alert(a)):(r=t.ItemsResult.Items[0]).Offers?i.setAttributes({isUrlPresent:!0,buyLink:r.DetailPageURL,headline:r.ItemInfo.Title.DisplayValue,productImage:r.Images.Primary.Large.URL,price:r.Offers.Listings[0].Price.DisplayAmount,checkPrice:"Buy Now on Amazon"}):alert("Product is not available!"):alert("500 internal server error"),i.setAttributes({loaderState:!1})}))},label:"URL",help:"Enter or paste URL for amazon product"})),d("div",{className:o?"product--details show":"product--details"},d(m,{value:t,label:"Category",onChange:function(e){a.setAttributes({category:e})}}),d(m,{value:r,label:"Headline",onChange:function(e){a.setAttributes({headline:e})}}),d(m,{value:i,label:"Price",disabled:!0}),d(m,{value:s,label:"Review",onChange:function(e){a.setAttributes({review:e})}}),d(m,{value:n,label:"Product Image",onChange:function(e){a.setAttributes({productImage:e})}}),d(m,{value:l,label:"Buy Link",onChange:function(e){a.setAttributes({buyLink:e})}}),d(m,{value:c,label:"Check Price",onChange:function(e){a.setAttributes({checkPrice:e})}})),d("div",{className:u?"block--overlay show":"block--overlay"},d("div",{className:"block--loader"}))),!a.isSelected&&!e&&d("div",{className:"url-not-found"},"Please enter URL of the product!"),!a.isSelected&&!!e&&!i&&d("div",{className:"url-not-found"},"Product is not available!"),!a.isSelected&&!!e&&!!i&&d("div",{className:"review-feature"},d("a",{href:a.attributes.buyLink,target:"_blank",el:"noopener noreferrer",rel:"noopener noreferrer"},d("div",{className:"the-container secondary"},d("h4",{className:"award"},a.attributes.category),d("div",null,d("div",null,d("div",{className:"all-content"},d("div",{className:"image-content"},d("a",{className:"image-link merchant-link"},d("figure",{className:"the-image"},d("img",{className:"product-image image-secondary",src:a.attributes.productImage})))),d("div",{className:"text-content"},d("h3",{className:"headline"},d("span",{className:"product-link"},a.attributes.headline)),d("h2",{className:"subtitle"},d("span",{className:"merchant-link",id:"product-link-subtitle"},a.attributes.price)),d("p",{className:"review-exerpt"},a.attributes.review),d("div",null,d("div",{className:"box-button"},d("span",{className:"button-link merchant-link"},d("span",null,a.attributes.checkPrice)))))))),d("span",{className:"the-disclaimer"},"We earn a commission if you click this link & make a purchase.")))))}})}(window.wp.blocks,window.wp.components);